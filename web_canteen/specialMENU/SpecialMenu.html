<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Special Menu</title>
    <link rel="stylesheet" href="/review-app/style.css">
    <style>
        
    </style>

    <script>
        const binId = "67c3486bad19ca34f814ab07";  // üî• ‡πÉ‡∏™‡πà Bin ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const apiKey = "$2a$10$xxsBsxICs7ST0gmrZfxnAum/ZeB2303vLfUVwuYCEPy2k8xIz0Efe"; // üî• ‡πÉ‡∏™‡πà API Key ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const apiUrl = `https://api.jsonbin.io/v3/b/${binId}`;

        // ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å JSONBin ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ "Special Menu"
        
        function displayReviews(reviews) {
            const reviewTable = document.getElementById("reviewTable");
            reviewTable.innerHTML = "<tr><th>‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</th><th>‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£</th><th>‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th><th>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</th></tr>";

            reviews.forEach(review => {
                let row = reviewTable.insertRow();
                row.innerHTML = `
                    <td>${review.‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£}</td>
                    <td>${review.‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£}</td>
                    <td>${review.‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£}</td>
                    <td>${review.‡∏£‡∏µ‡∏ß‡∏¥‡∏ß}</td>
                    <td>${review.‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô}</td>
                    <td><img src="${review.‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û}" width="100"></td>
                `;
            });
        }

        async function addReview() {
            const canteen = document.getElementById("canteen").value;
            const restaurant = document.getElementById("restaurant").value;
            const dish = document.getElementById("dish").value;
            const review = document.getElementById("review").value;
            const rating = document.getElementById("rating").value;
            const image = document.getElementById("image").value;
            const messageBox = document.getElementById("message");

            if (!canteen || !restaurant || !dish || !review || !rating || !image) {
                messageBox.innerText = "‚ö†Ô∏è ‡πÇ‡∏õ‡∏£‡∏î‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô!";
                messageBox.style.color = "red";
                return;
            }

            const newReview = {
                "‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£": canteen,
                "‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£": restaurant,
                "‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£": dish,
                "‡∏£‡∏µ‡∏ß‡∏¥‡∏ß": review,
                "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô": parseInt(rating),
                "‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û": image
            };

            try {
                const response = await fetch(apiUrl, { headers: { "X-Master-Key": apiKey } });
                const data = await response.json();
                const reviews = data.record.reviews;
                reviews.push(newReview);

                await fetch(apiUrl, {
                    method: "PUT",
                    headers: {
                        "Content-Type": "application/json",
                        "X-Master-Key": apiKey
                    },
                    body: JSON.stringify({ reviews })
                });

                loadReviews(); 

                document.getElementById("canteen").value = "";
                document.getElementById("restaurant").value = "";
                document.getElementById("dish").value = "";
                document.getElementById("review").value = "";
                document.getElementById("rating").value = "";
                document.getElementById("image").value = "";

                messageBox.innerText = "‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!";
                messageBox.style.color = "green";

                setTimeout(() => { messageBox.innerText = ""; }, 2000);
            } catch (error) {
                console.error("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏µ‡∏ß‡∏¥‡∏ß:", error);
                messageBox.innerText = "‚ùå ‡∏°‡∏µ‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!";
                messageBox.style.color = "red";
            }
        }

        function toggleMenu() {
            const mobileNav = document.getElementById("mobileNav");
            mobileNav.style.display = (mobileNav.style.display === "flex") ? "none" : "flex";
        }
    </script>
</head>

<body onload="loadReviews()">
    <div class="navbar">
        <button class="hamburger" onclick="toggleMenu()">‚ò∞</button>
        <div class="nav-links">
            <a href="/specialMENU/SpecialMenu.html">Special Menu</a>
            <a href="/review-app/canteenA/ReviewA.html">‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ A</a>
            <a href="/review-app/canteenB/ReviewB.html">‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ B</a>
            <a href="/review-app/canteenC/ReviewC.html">‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ C</a>
            <a href="/review-app/canteenVidya/ReviewVidya.html">‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ Vidya</a>
        </div>
        <div class="mobile-nav" id="mobileNav">
            <a href="/specialMENU/SpecialMenu.html">Special Menu</a>
            <a href="/review-app/canteenA/ReviewA.html">‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ A</a>
            <a href="/review-app/canteenB/ReviewB.html">‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ B</a>
            <a href="/review-app/canteenC/ReviewC.html">‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ C</a>
            <a href="/review-app/canteenVidya/ReviewVidya.html">‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ Vidya</a>
        </div>
    </div>

    <h2>Special Menu</h2>

    <table border="1" id="reviewTable"></table>

    <div class="input-container">
        <h3 style="text-align: center; color: #E37A58;">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏´‡∏°‡πà‡πÜ‡πÄ‡∏à‡πä‡∏á‡πÜ‡πÄ‡∏Å‡πã‡πÜ‡∏Ñ‡∏π‡∏•‡πÜ</h3>
        <label>‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£:</label>
        <input type="text" id="canteen" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£">
        
        <label>‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£:</label>
        <input type="text" id="restaurant" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£">
        
        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£:</label>
        <input type="text" id="dish" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£">
        
        <label>‡∏£‡∏µ‡∏ß‡∏¥‡∏ß:</label>
        <input type="text" id="review" placeholder="‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£">
        
        <label>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô:</label>
        <input type="number" id="rating" min="1" max="5" placeholder="1-5">
        
        <label>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û URL:</label>
        <input type="text" id="image" placeholder="‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û">
        
        <button onclick="addReview()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</button>
    </div>
    <div id="message" style="text-align:center; font-weight:bold; margin-top:10px;"></div>

</body>
</html>
